class MobileTouchControls{constructor(t={}){this.options={swipeThreshold:30,tapThreshold:10,doubleTapThreshold:300,longPressThreshold:500,vibrationEnabled:!0,feedbackEnabled:!0,...t},this.touchState={startX:0,startY:0,startTime:0,lastTap:0,moved:!1,isLongPress:!1,longPressTimer:null},this.init()}init(){this.addMobileStyles(),this.disableDefaultTouchBehaviors(),this.addTouchFeedback(),console.log("Mobile Touch Controls initialized")}addMobileStyles(){const t=document.createElement("style");t.textContent="\n            /* Mobile Touch Optimizations */\n            .touch-optimized {\n                -webkit-touch-callout: none;\n                -webkit-user-select: none;\n                -khtml-user-select: none;\n                -moz-user-select: none;\n                -ms-user-select: none;\n                user-select: none;\n                -webkit-tap-highlight-color: transparent;\n            }\n\n            .touch-target {\n                min-height: 44px;\n                min-width: 44px;\n                position: relative;\n            }\n\n            .touch-feedback {\n                position: absolute;\n                pointer-events: none;\n                border-radius: 50%;\n                background: rgba(145, 217, 248, 0.3);\n                transform: scale(0);\n                animation: touchRipple 0.6s ease-out;\n            }\n\n            @keyframes touchRipple {\n                to {\n                    transform: scale(2);\n                    opacity: 0;\n                }\n            }\n\n            .long-press-indicator {\n                position: absolute;\n                top: 50%;\n                left: 50%;\n                transform: translate(-50%, -50%);\n                width: 60px;\n                height: 60px;\n                border: 3px solid rgba(145, 217, 248, 0.8);\n                border-radius: 50%;\n                border-top-color: transparent;\n                animation: longPressSpinner 0.5s linear;\n                pointer-events: none;\n            }\n\n            @keyframes longPressSpinner {\n                from { transform: translate(-50%, -50%) rotate(0deg); }\n                to { transform: translate(-50%, -50%) rotate(360deg); }\n            }\n\n            /* Game-specific mobile improvements */\n            .game-board {\n                touch-action: none;\n            }\n\n            .draggable-item {\n                cursor: grab;\n                transition: transform 0.2s ease;\n            }\n\n            .draggable-item:active,\n            .draggable-item.dragging {\n                cursor: grabbing;\n                transform: scale(1.05);\n                z-index: 1000;\n                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);\n            }\n\n            /* Mobile button improvements */\n            @media (max-width: 768px) {\n                button, .btn {\n                    min-height: 44px;\n                    min-width: 44px;\n                    padding: 12px 20px;\n                    font-size: 16px;\n                    touch-action: manipulation;\n                }\n\n                .game-controls {\n                    padding: 20px;\n                    gap: 15px;\n                }\n\n                .score-display {\n                    font-size: 1.2em;\n                    padding: 10px;\n                }\n            }\n        ",document.head.appendChild(t)}disableDefaultTouchBehaviors(){document.addEventListener("touchstart",t=>{this.isGameElement(t.target)&&(t.target.closest(".scroll-allowed")||t.preventDefault())},{passive:!1}),document.addEventListener("touchmove",t=>{this.isGameElement(t.target)&&t.preventDefault()},{passive:!1});let t=0;document.addEventListener("touchend",e=>{const n=(new Date).getTime();n-t<=300&&this.isGameElement(e.target)&&e.preventDefault(),t=n},!1)}isGameElement(t){return t.closest(".game-container, .game-board, .game-area, canvas, .grid-container")}addTouchFeedback(){document.addEventListener("touchstart",t=>{this.options.feedbackEnabled&&this.isInteractiveElement(t.target)&&this.showTouchFeedback(t.touches[0])})}isInteractiveElement(t){return t.matches('button, .btn, .clickable, .draggable, .checker, .tile, .card, input[type="button"], input[type="submit"]')||t.closest("button, .btn, .clickable, .draggable")}showTouchFeedback(t){const e=document.createElement("div");e.className="touch-feedback",e.style.left=t.clientX-25+"px",e.style.top=t.clientY-25+"px",e.style.width="50px",e.style.height="50px",document.body.appendChild(e),setTimeout(()=>{e.remove()},600)}setupEnhancedTouchEvents(t,e={}){t&&(t.classList.add("touch-optimized"),t.addEventListener("touchstart",n=>{const o=n.touches[0];this.touchState.startX=o.clientX,this.touchState.startY=o.clientY,this.touchState.startTime=Date.now(),this.touchState.moved=!1,this.touchState.isLongPress=!1,this.touchState.longPressTimer=setTimeout(()=>{this.touchState.isLongPress=!0,e.onLongPress&&(this.vibrate(50),this.showLongPressIndicator(t),e.onLongPress(n,{x:this.touchState.startX,y:this.touchState.startY}))},this.options.longPressThreshold),e.onTouchStart&&e.onTouchStart(n,{x:this.touchState.startX,y:this.touchState.startY})}),t.addEventListener("touchmove",t=>{const n=t.touches[0],o=n.clientX-this.touchState.startX,s=n.clientY-this.touchState.startY,i=Math.sqrt(o*o+s*s);i>this.options.tapThreshold&&(this.touchState.moved=!0,clearTimeout(this.touchState.longPressTimer)),e.onTouchMove&&e.onTouchMove(t,{x:n.clientX,y:n.clientY,deltaX:o,deltaY:s,distance:i})}),t.addEventListener("touchend",n=>{clearTimeout(this.touchState.longPressTimer);const o=Date.now()-this.touchState.startTime,s=Date.now();if(this.touchState.moved||this.touchState.isLongPress){if(this.touchState.moved){const t=n.changedTouches[0],s=t.clientX-this.touchState.startX,i=t.clientY-this.touchState.startY,a=Math.sqrt(s*s+i*i);if(a>this.options.swipeThreshold){const t=this.getSwipeDirection(s,i);e.onSwipe&&(this.vibrate(40),e.onSwipe(n,{direction:t,distance:a,deltaX:s,deltaY:i,velocity:a/o}))}}}else s-this.touchState.lastTap<this.options.doubleTapThreshold?e.onDoubleTap&&(this.vibrate(30),e.onDoubleTap(n,{x:this.touchState.startX,y:this.touchState.startY})):e.onTap&&(this.vibrate(20),e.onTap(n,{x:this.touchState.startX,y:this.touchState.startY})),this.touchState.lastTap=s;e.onTouchEnd&&e.onTouchEnd(n,{duration:o,moved:this.touchState.moved,isLongPress:this.touchState.isLongPress}),this.removeLongPressIndicator(t)}))}getSwipeDirection(t,e){return Math.abs(t)>Math.abs(e)?t>0?"right":"left":e>0?"down":"up"}showLongPressIndicator(t){const e=document.createElement("div");e.className="long-press-indicator",t.style.position="relative",t.appendChild(e)}removeLongPressIndicator(t){const e=t.querySelector(".long-press-indicator");e&&e.remove()}vibrate(t){this.options.vibrationEnabled&&"vibrate"in navigator&&navigator.vibrate(t)}setupDragAndDrop(t,e,n={}){const o=document.querySelectorAll(t),s=document.querySelectorAll(e);o.forEach(t=>{t.classList.add("draggable-item"),this.setupEnhancedTouchEvents(t,{onTouchStart:(e,o)=>{t.classList.add("dragging"),n.onDragStart&&n.onDragStart(t,e,o)},onTouchMove:(o,i)=>{t.style.position="fixed",t.style.left=i.x-25+"px",t.style.top=i.y-25+"px",t.style.zIndex="1000";const a=document.elementFromPoint(i.x,i.y),r=a?.closest(e);s.forEach(t=>{t.classList.remove("drop-hover")}),r&&r.classList.add("drop-hover"),n.onDragMove&&n.onDragMove(t,o,i,r)},onTouchEnd:(o,i)=>{t.classList.remove("dragging"),t.style.position="",t.style.left="",t.style.top="",t.style.zIndex="";const a=document.elementFromPoint(i.x||this.touchState.startX,i.y||this.touchState.startY),r=a?.closest(e);s.forEach(t=>{t.classList.remove("drop-hover")}),r&&n.onDrop?n.onDrop(t,r,o,i):n.onDragCancel&&n.onDragCancel(t,o,i)}})})}addSwipeControls(t,e){this.setupEnhancedTouchEvents(t,{onSwipe:(t,n)=>{e(n.direction,n)}})}addTapControls(t,e){t.forEach(t=>{this.setupEnhancedTouchEvents(t,{onTap:(n,o)=>{e(t,n,o)}})})}initializeFor2048(t){this.addSwipeControls(t,t=>{const e={up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight"};if(e[t]){const n=new KeyboardEvent("keydown",{key:e[t]});document.dispatchEvent(n)}})}initializeForBackgammon(t){this.setupDragAndDrop(".checker",".point, .bar, .home-area",{onDragStart:(t,e,n)=>{t.click()},onDrop:(t,e,n,o)=>{e.click()}});const e=t.querySelector(".dice-container, .dice-area");e&&this.setupEnhancedTouchEvents(e,{onTap:()=>{const t=document.querySelector('[onclick*="rollDice"], .roll-btn');t&&t.click()}})}initializeForPuzzleGames(t){const e=t.querySelectorAll(".cell, .grid-cell, .card");this.addTapControls(e,(t,e,n)=>{t.click()})}}window.addEventListener("DOMContentLoaded",()=>{if(window.innerWidth<=768||"ontouchstart"in window){const t=new MobileTouchControls,e=document.querySelector(".game-container, .game-board, .game-area");e&&((document.querySelector(".grid-container, .tile-container")||document.title.includes("2048"))&&t.initializeFor2048(e),(document.querySelector(".checker, .point")||document.title.includes("Backgammon"))&&t.initializeForBackgammon(e),document.querySelector(".sudoku-grid, .memory-grid, .puzzle-grid")&&t.initializeForPuzzleGames(e)),window.mobileControls=t}});